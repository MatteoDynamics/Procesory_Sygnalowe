$(document).on("click",".accept-license",function(a){window.STFED="undefined"===typeof STFED?{}:STFED;var b=STFED.getSoftwareDialog,h=b.startSoftwareDownload,f=b.showValidationModalAndInsertFields,k=b.startLmuSoftwareDownload;a.preventDefault();var c=$(this).data("gsContent")||$(this).closest(".gscontent");a=c.data("licenseModal")||c.find("#licenseModal");var p=document.getElementById("loginOrCreateAccountModal-loader");c.data("product-item-name");640>window.innerWidth&&(p.style.display="flex");a.modal("hide");
$.ajax({url:"/bin/st/save-license-agreements",async:!0,type:"POST",dataType:"json",data:{resourceType:"SW",path:a.data("section-path"),version:a.data("license-version"),versionDate:a.data("license-date"),productId:c.data("software-prmis-id")}}).complete(function(e){p.style.display="none";var d=c.find("#initLightDownload"),l=c.find("#gatherEmail"),m=c.find("#lmuValidation"),g=c.find("#regRequired"),n=c.find("#initDownload");e&&(e=e.getResponseHeader("marker"))&&(localStorage.markerEncrypted=e);void 0!==
d&&0<d.length?0<$("#userLogged").length?($(d).hasClass("table-button-blue")&&0===$(".stm32-software-downloads").length&&d.text("Download latest"),d.attr("data-ds-button","download"),d.removeClass("license-accept").addClass("license-skip"),h(c,PAGE)):(c.data("secondDownloadCreateAccountModal")||c.find("#secondDownloadCreateAccountModal")).modal("toggle"):void 0!==l&&0<l.length?(l.removeClass("license-accept"),l.addClass("license-skip"),c.data("loginOrCreateAccountModal").modal("toggle"),STFED.foundation.init()):
void 0!==m&&0<m.length?f(c):void 0!==g&&0<g.length?(d=g.data("reg-path"),m=g.data("software-button-for-product"),n=g.data("version"),void 0!==d&&""!==d&&(g=d.indexOf("license"),e=d.substring(g).split("."),l=e[0].split("\x3d")[1],m||(console.error("software-button-for-product not defined"),m=e[1].split("\x3d")[1]),n||(console.error("version not defined"),n=e[2].split("\x3d")[1]+"."+e[3]+"."+e[4]),STUtils.setCookieByName(productCookieName,m),STUtils.setCookieByName(licenseCookieName,l),STUtils.setCookieByName(versionCookieName,
n),console.log("creating the cookies before redirecting"),window.location.href=-1<g?d.substring(0,g)+"html":d)):void 0!==n&&0<n.length&&k(c)})});$(document).on("click",".decline-license",function(){$(this).data("gsContent").data("licenseModal").modal("hide")});
function getRegistrationCookies(a){var b=a.find("#gatherEmail"),h=b.data("reg-path");0===b.length&&(b=a,h=b.data("reg-required-link-path"));a=(new URLSearchParams((new URL(h)).search)).get("service").split(".license")[0];var f=h.indexOf("license");f=h.substring(f).split(".");h=f[0].split("\x3d")[1];var k=b.data("software-button-for-product");b=b.data("version");k=k?k:f[1].split("\x3d")[1];b=b?b:f[2].split("\x3d")[1]+"."+f[3]+"."+f[4];return{productValue:k,licenseValue:h,versionValue:b,serviceParamNoParams:a}}
$(document).on("click",".download-guest-text",function(){var a=$(this).closest(".gscontent");a.data("loginOrCreateAccountModal").modal("hide");var b=a.find("script").attr("id");localStorage.setItem("scriptId",b);b=a.find("#gatherEmail").data("download-path-encrypted");localStorage.setItem("downloadPathEncrypted",b);W3C.CookieFunctions.setCookieWithoutOneTrustCheck("statusDownload","first_download",9E3);b=findLanguage(window.location.pathname);sessionStorage.setItem("getSWPageName",window.digitalData.page.pageInfo.pageName);
a=getRegistrationCookies(a);localStorage.setItem("productName",a.productValue);localStorage.setItem("licenseName",a.licenseValue);localStorage.setItem("versionName",a.versionValue);localStorage.setItem("downloadLinkRegister",a.serviceParamNoParams);window.location.href="/content/st_com/"+b+"/download-as-guest.html"});
$(document).on("click",".second-download-guest-text",function(){var a=$(this).closest(".gscontent");$("#secondDownloadCreateAccountModal").modal("hide");localStorage.setItem("scriptId",a.find("script").attr("id"));W3C.CookieFunctions.setCookieWithoutOneTrustCheck("statusDownload","second_download",9E3);a=findLanguage(window.location.pathname);sessionStorage.setItem("getSWPageName",window.digitalData.page.pageInfo.pageName);window.location.href="/content/st_com/"+a+"/download-as-guest.html"});
$(document).on("click",".login-or-create-button",function(){var a=$(this).closest(".gscontent");a=getRegistrationCookies(a);STUtils.setCookieByName(productCookieName,a.productValue);STUtils.setCookieByName(licenseCookieName,a.licenseValue);STUtils.setCookieByName(versionCookieName,a.versionValue);a=a.serviceParamNoParams;STUtils.setCookieByName("downloadlinkregister",a);a.includes(".html")||(a+=".html");if(a="/content/st_com/"+findLanguage(window.location.pathname)+"/user-registration.html?referrer\x3d"+
a)window.location.href=a});$(document).on("ready",function(){$(".agreement-copy.license-agreement section").each(function(){$(this).contents().filter(function(){return 3===this.nodeType&&0<$.trim(this.textContent).length}).wrap("\x3cp\x3e\x3c/p\x3e")})});function findLanguage(a){a=a.split("/");if(!a.find(function(b){return"en"===b})){if(a.find(function(b){return"ja"===b}))return"ja";if(a.find(function(b){return"zh"===b}))return"zh"}return"en"}
$(document).ready(function(){641>$(window).width()&&setHeight();$(".file-icon-parent-container .pdf-download.dialog-label").each(function(){this.getAttribute("href").includes("https")&&this.firstElementChild.setAttribute("src","/etc/clientlibs/st-site-cx/media/app/images/svg/icon-weblink.svg")})});$(window).resize(function(){641>$(window).width()&&setHeight()});function setHeight(){var a=$(window).height();$(".agreement-copy.license-agreement").css("height",a-.41*a)};